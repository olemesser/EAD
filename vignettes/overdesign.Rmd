---
title: "Overdesign"
author: "Ole Jan MeÃŸerschmidt"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Overdesign}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
bibliography: '`r system.file("REFERENCES.bib", package="EAD")`'
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Introduction

This vignette explains the function to manipulate $DMM_{FD,PD}$ in order to generate different degrees of component overdesign. In doing so, the initial domain mapping matrix is overdesigned step by step:

```{r overdesign}
library(EAD)
set.seed(123)
EAD <- smallEAD
EAD$DMM$FD_PD
```

# Simulational Procedure

In the numerical experiments, an increasing degree is modeled as follows. For each generated product family, the degree of component commonality is increased by increasing the coupling in $DMM_{FD,PD}$ as long as there are at least two components available. In each step, only two components are replaced at ones resulting in design steps. The replacement works as follows. First a component is randomly selected, its nearest neighbor component is calculated and selected as a component to be substituted. It is possible to select the second component also by random chance, however, the nearest neighbor search ensures that these two components share some similarities. This reflects more practical settings since it is more likely that engineering, for example, standardizes a small and large beam instead of a small beam and a cabinet. The following chunk visualizes the procedure.

```{r}
## define output object
res <- data.frame(SDC_N=NA,
           TC_var=NA,
           N_PD=NA)

## calculate values for initial design
costs_inital<-clc_PCB(EAD$P$RD,
                   DMD = EAD$DEMAND,
                   RC_direct = EAD$RC$direct,
                   RC_var = rep(0,NCOL(EAD$P$RD)))
res[1,]<-c(EAD$measures$SYSTEM$SDC_n$FD_PD,
           sum(costs_inital$PC_B * EAD$DEMAND),
           EAD$measures$SYSTEM$N_PD)
i<-2
while(sum(colSums(EAD$DMM$FD_PD)>0)>1){
  EAD<-overdesign_EAD(EAD)
  message(paste0("\nDMM_FD_PD at step S",i-1))
  print(EAD$DMM$FD_PD)
  res[i,]<-c(EAD$measures$SYSTEM$SDC_n$FD_PD,
           sum(clc_PCB(EAD$P$RD,
                   DMD = EAD$DEMAND,
                   RCU_direct = costs_inital$RCU_direct,
                   RC_var = rep(0,NCOL(EAD$P$RD)))$PC_B * EAD$DEMAND),
           EAD$measures$SYSTEM$N_PD)
  i <- i+1
}
```

See the results

```{r}
res
```

@Mertens.2020

# References

